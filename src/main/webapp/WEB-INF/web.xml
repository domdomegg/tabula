<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns="http://java.sun.com/xml/ns/j2ee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd" version="2.4">
 
  <context-param>
    <param-name>contextClass</param-name>
    <param-value>
      org.springframework.web.context.support.AnnotationConfigWebApplicationContext
    </param-value>
  </context-param>
  
  <context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>uk.ac.warwick.courses.config.Application</param-value>
  </context-param> 
 
  <listener>
   <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
  </listener>
   
   <servlet>
       <servlet-name>spring</servlet-name>
       <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
       <init-param>
           <param-name>contextClass</param-name>
           <param-value>org.springframework.web.context.support.AnnotationConfigWebApplicationContext</param-value>
       </init-param>
       <init-param>
           <param-name>contextConfigLocation</param-name>
           <param-value>uk.ac.warwick.courses.config.Web</param-value>
       </init-param>
       <load-on-startup>1</load-on-startup>
   </servlet>

  <servlet-mapping>
    <servlet-name>spring</servlet-name>
    <url-pattern>/</url-pattern>
  </servlet-mapping>
  
  <!-- To make Freemarker templates available to Tiles -->  
  <servlet>
    <servlet-name>freemarker</servlet-name>
    <servlet-class>org.apache.tiles.freemarker.servlet.TilesFreemarkerServlet</servlet-class>
    <init-param><param-name>TemplatePath</param-name><param-value>/</param-value></init-param>
    <init-param><param-name>NoCache</param-name><param-value>true</param-value></init-param>
    <init-param><param-name>ContentType</param-name><param-value>text/html</param-value></init-param>
    <init-param><param-name>default_encoding</param-name><param-value>UTF-8</param-value></init-param>
    <init-param><param-name>output_encoding</param-name><param-value>UTF-8</param-value></init-param>
    <load-on-startup>5</load-on-startup>
  </servlet>
  <servlet-mapping>
  	<servlet-name>freemarker</servlet-name>
  	<url-pattern>*.ftl</url-pattern>
  </servlet-mapping>
  
  <!-- Help JSP taglibs to work properly within Freemarker http://freemarker.sourceforge.net/docs/pgui_misc_servlet.html -->
  <listener>
    <listener-class>freemarker.ext.jsp.EventForwarding</listener-class>
  </listener>  

</web-app>